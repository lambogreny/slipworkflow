# EasySlip - แผนภาพการตรวจสอบสลิป

## แผนภาพการตรวจสอบสลิปและการจัดการQuota

```mermaid
flowchart TD
    A[ลูกค้า] -->|อัพโหลดสลิป| B{ตรวจสอบสลิป}
    B -->|สลิปถูกต้องมีข้อมูล| C[ประมวลผลสลิป]
    B -->|สลิปไม่ถูกต้องแต่มีข้อมูล| D[ปฏิเสธสลิป]
    B -->|สลิปไม่พบข้อมูล| N[ปฏิเสธสลิป (ไม่มีข้อมูล)]
    B -->|สลิปซ้ำ| E[ระบุว่าเป็นสลิปซ้ำ]
    
    C -->|หักQuota| F[ตรวจสอบเสร็จสมบูรณ์]
    D -->|ลูกค้าอัพโหลดสลิปใหม่| B
    N -->|ไม่หักQuota| O[ลูกค้าอัพโหลดสลิปใหม่]
    O --> B
    E -->|ไม่หักQuota| F
    
    subgraph "กฎการจัดการQuota"
        G[สลิปถูกต้องมีข้อมูล] -->|"หักQuota"| H[Quotaลดลง]
        I[สลิปไม่ถูกต้องแต่มีข้อมูล] -->|"หักQuota"| H
        J[สลิปซ้ำ] -->|"ไม่หักQuota"| K[Quotaไม่เปลี่ยนแปลง]
        L[สลิปไม่พบข้อมูล] -->|"ไม่หักQuota"| K
    end
```

## กฎการหักQuota

1. **Quotaจะถูกหักเมื่อ:**
   - สลิปที่มีข้อมูลถูกประมวลผล
   - สลิปไม่ถูกต้องแต่มีข้อมูลถูกอัพโหลด

2. **Quotaจะไม่ถูกหักเมื่อ:**
   - สลิปซ้ำถูกอัพโหลด (เหมือนกับสลิปที่เคยประมวลผลไปแล้ว)
   - สลิปไม่พบข้อมูลถูกอัพโหลด (สลิปที่ไม่มีข้อมูลใดๆ)

## กระบวนการส่งสลิปใหม่ของลูกค้า

```mermaid
sequenceDiagram
    participant ลูกค้า
    participant ระบบ
    
    ลูกค้า->>ระบบ: อัพโหลดสลิป
    alt สลิปถูกต้อง
        ระบบ->>ระบบ: ประมวลผลสลิป
        ระบบ->>ระบบ: หักQuota
        ระบบ->>ลูกค้า: ตรวจสอบเสร็จสมบูรณ์
    else สลิปไม่ถูกต้อง
        alt สลิปมีข้อมูล
            ระบบ->>ระบบ: หักQuota
        else สลิปไม่พบข้อมูล
            ระบบ->>ระบบ: ไม่หักQuota
        end
        ระบบ->>ลูกค้า: แจ้งปฏิเสธ
        ลูกค้า->>ระบบ: อัพโหลดสลิปใหม่
        ระบบ->>ระบบ: ตรวจสอบสลิปใหม่
        alt สลิปใหม่ไม่ซ้ำ
            ระบบ->>ระบบ: หักQuota
        else สลิปซ้ำ
            ระบบ->>ระบบ: ไม่หักQuota
        end
        ระบบ->>ลูกค้า: ผลการตรวจสอบ
    end
